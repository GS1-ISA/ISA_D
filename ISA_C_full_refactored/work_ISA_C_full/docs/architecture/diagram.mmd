flowchart LR
  subgraph Sources
    EUCellar[EU Cellar]:::src
    EFRAG[EFG/EFRAG]:::src
    Eurostat[Eurostat]:::src
    SEC[US SEC]:::src
    GS1[GS1]:::src
    GS1NL[GS1 NL]:::src
  end

  subgraph ISA_C Core
    Runner[CLI Runner]:::core
    Prefect[Prefect Flow]:::opt
    Adapters[Adapters (Strategy)]:::core
    Storage[DuckDB Idempotency]:::opt
    Cache[Cache Layer]:::opt
  end

  EUCellar --> Adapters
  EFRAG --> Adapters
  Eurostat --> Adapters
  SEC --> Adapters
  GS1 --> Adapters
  GS1NL --> Adapters

  Adapters --> Runner
  Runner --> Storage
  Runner --> Cache
  Prefect --> Adapters

  Adapters -->|CSV/Parquet| Raw[(data/raw)]
  Raw --> Staged[(data/staged)] --> Validated[(data/validated)] --> Curated[(data/curated)]

  classDef src fill:#e3f2fd,stroke:#1e88e5,stroke-width:1px;
  classDef core fill:#e8f5e9,stroke:#43a047,stroke-width:1px;
  classDef opt fill:#fff3e0,stroke:#fb8c00,stroke-width:1px;
